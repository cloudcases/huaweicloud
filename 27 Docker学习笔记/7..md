docker学习笔记7：发布镜像到docker hub上

镜像创建好后，很重要的一个操作就是共享和发布。可以将自己创建的镜像发布到docker hub上，也可以发布到自己的私有docker hub上。

要想发布镜像到dokcer hub上，首先要在dokcer hub上注册账户，并且在本机（准备提交镜像到docker hub的机器上）上进行注册。具体过程如下：

1、登录 网站注册一个用户，如 jeme。注册时需要提供邮箱进行验证。
2、在本机用docker login 向docker hub注册（登录），如：
xxx@ubuntu:~$ docker login
Username: jeme
Password:
Email: xxxxxxxx@sss.sss
WARNING: login credentials saved in /home/xxx/.docker/config.json
Login Succeeded

说明：验证通过后，就可以开始将本地创建的镜像发布到docker hub自己的账户下了。

可以通过 docker logout命令退出docker hub，退出后就没法发布镜像到docker hub，除非再次注册。

3、发布镜像

docker push 用户名/仓库名[:tag名]

这里的 用户名/仓库名[:tag名]  代表的镜像必须是本机存在的，tag名不写的话默认就是latest。 也就是说在创建镜像时的命名必须是规范的格式（加用户名）。

并且用户名就是自己在docker hub上注册的名称。如这里的jeme.

发布成功后，这时我们用docker search 就能搜到自己提的镜像。 

docker学习笔记11：Dockerfile 指令 CMD介绍

我们知道，通过docker run 创建并启动一个容器时，命令的最后可以指定容器启动后在容器内立即要执行的指令，如：

docker run -i -t ubunu /bin/bash   //表示容器启动时立即在容器内打开一个shell终端

docker run ubuntu /bin/ps    //表示容器启动后立即运行 /bin/ps命令，显示容器的当前进程。

除了这种方式外，我们可以在dockerfile文件中通过CMD指令指定容器启动时要执行的命令。如：
#test
FROM ubuntu
MAINTAINER xxx
RUN echo hello1 > test1.txt
RUN echo hello2 > /test2.txt
EXPOSE 80
EXPOSE 81
CMD ["/bin/bash"]

上面dockerfile文件中最后一行CMD指令的参数是指定容器启动时要执行的命令，这里是bin/bash命令。

1、用docker run命令创建并启动容器（myimage  是用前面dockerfile创建的镜像的名称）：
docker run -i -t myimage  
上面命令是创建并启动容器，打开一个交互式shell。 而以前的写法是

docker run -i -t myimage  /bin/bash

这样就省去了在docker run中写命令了。

2、即使dockerfile中有CMD指令，我们仍然可以在docker run命令中带上容器启动时执行的命令，这会覆盖dockerfile中的CMD指令指定的命令。如：

docker run -i -t myimage /bin/ps

上面命令，因为/bin/ps覆盖了CMD指令，启动容器时会打印容器内的当前进程，但容器会立即停止，因为/bin/bash被覆盖了，无法打开交互式shell界面。

3、需要注意的是，dockerfile中可以有多条cmd命令，但只是最后一条有效。

4、CMD命令的参数格式，一般写成 字符串数组的方式，如上面的例子。如：

CMD  ["echo","hello world"]

虽然也可写成CMD echo hello word 方式，但这样docker会在指定的命令前加  /bin/sh -c 执行，有时有可能会出问题。 所以推荐采用数据结构的方式来存放命令。