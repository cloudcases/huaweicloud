# 创建安全组

更新时间：2021/01/28 GMT+08:00

#### 操作场景

您可以创建安全组并定义安全组中的规则，**将VPC中的弹性云服务器划分成不同的安全域，以提升弹性云服务器访问的安全性**。

建议您**将不同公网访问策略的弹性云服务器划分到不同的安全组**。

#### 操作步骤

1. 登录管理控制台。

2. 在管理控制台左上角单击![img](https://support.huaweicloud.com/qs-vpn/zh-cn_image_0295711304.png)，选择区域和项目。

3. 在系统首页，选择“网络 > 虚拟私有云”。

4. 在左侧导航树选择“访问控制 > 安全组”。

5. 在“安全组”界面，单击“创建安全组”。

6. 在“创建安全组”界面，根据界面提示配置参数，参数说明参考

   表1。

   | 参数     | 参数说明                                                     | 取值样例      |
   | -------- | ------------------------------------------------------------ | ------------- |
   | 模板     | 模板自带安全组规则，方便您快速创建安全组。提供如下几种模板：自定义：用户自定义安全组规则。**通用Web服务器：默认放通22、3389、80、443端口和ICMP协议**。开放全部端口：开放全部端口有一定安全风险，请谨慎选择。 | 通用Web服务器 |
   | 名称     | 安全组的名称，必填项。安全组的名称只能由中文、英文字母、数字、“_”、“-”和“.”组成，且不能有空格，长度不能大于64个字符。**说明：**安全组名称创建后可以修改，建议不要重名。 | sg-318b       |
   | 企业项目 | 创建安全组时，可以将安全组加入已启用的企业项目。企业项目管理提供了一种按企业项目管理云资源的方式，帮助您实现以企业项目为基本单元的资源及人员的统一管理，默认项目为default。关于创建和管理企业项目的详情，请参见[《企业管理用户指南》](https://support.huaweicloud.com/usermanual-em/zh-cn_topic_0131965280.html)。 | default       |
   | 描述     | 安全组的描述信息，非必填项。描述信息内容不能超过255个字符，且不能包含“<”和“>”。 | -             |

7. 单击“确定”。



# 添加安全组规则

更新时间：2021/01/28 GMT+08:00

#### 操作场景

安全组创建后，您可以在安全组中**设置出方向、入方向规则**，这些规则会**对安全组内部的云服务器出入方向网络流量进行访问控制**，当云服务器加入该安全组后，即受到这些访问规则的保护。

- **入方向**：指**从外部访问安全组规则下的弹性云服务器**。
- **出方向**：指**安全组规则下的弹性云服务器访问安全组外的实例**。

默认安全组规则请参见[默认安全组和规则](https://support.huaweicloud.com/usermanual-vpc/SecurityGroup_0003.html)。常用的安全组规则配置示例请参见[安全组配置示例简介](https://support.huaweicloud.com/usermanual-vpc/zh-cn_topic_0081124350.html)。

#### 操作步骤

1. 登录管理控制台。

2. 在管理控制台左上角单击![img](https://support.huaweicloud.com/qs-vpn/zh-cn_image_0295711424.png)，选择区域和项目。

3. 在系统首页，选择“网络 > 虚拟私有云”。

4. 在左侧导航树选择“访问控制 > 安全组”。

5. 在安全组界面，单击操作列的“配置规则”，进入安全组详情界面。

6. 在入方向规则页签，单击“添加规则”，添加入方向规则。

   单击“+”可以依次增加多条入方向规则。

   图1 添加入方向规则
   ![img](https://support.huaweicloud.com/qs-vpn/zh-cn_image_0295711326.png)

   | 参数                                                         | 说明                                                         | 取值样例   |
   | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------- |
   | 协议端口                                                     | 网络协议。目前支持“All”、“TCP”、“UDP”、“ICMP”和“GRE”等协议。 | Custom TCP |
   | 端口：允许远端地址访问弹性云服务器指定端口，取值范围为：1～65535。常用端口请参见[弹性云服务器常用端口](https://support.huaweicloud.com/usermanual-vpc/SecurityGroup_0002.html)。 | 22或22-30                                                    |            |
   | 类型                                                         | IP地址类型。开通IPv6功能后可见。IPv4IPv6                     | IPv4       |
   | 源地址                                                       | 源地址：可以是IP地址、安全组。例如：xxx.xxx.xxx.xxx/32（IPv4地址）xxx.xxx.xxx.0/24（子网）**0.0.0.0/0（任意地址）**sg-abc（安全组） | 0.0.0.0/0  |
   | 描述                                                         | 安全组规则的描述信息，非必填项。描述信息内容不能超过255个字符，且不能包含“<”和“>”。 | -          |

   

7. 在出方向规则页签，单击“添加规则”，添加出方向规则。

   单击“+”可以依次增加多条出方向规则。

   图2 添加出方向规则
   ![img](https://support.huaweicloud.com/qs-vpn/zh-cn_image_0295711456.png)

   | 参数                                                         | 说明                                                         | 取值样例   |
   | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------- |
   | 协议端口                                                     | 网络协议。目前支持“All”、“TCP”、“UDP”、“ICMP”和“GRE”等协议。 | Custom TCP |
   | 端口：允许弹性云服务器访问远端地址的指定端口，取值范围为：1～65535。常用端口请参见[弹性云服务器常用端口](https://support.huaweicloud.com/usermanual-vpc/SecurityGroup_0002.html)。 | 22或22-30                                                    |            |
   | 类型                                                         | IP地址类型。开通IPv6功能后可见。IPv4IPv6                     | IPv4       |
   | 源地址                                                       | 源地址：可以是IP地址、安全组。例如：xxx.xxx.xxx.xxx/32（IPv4地址）xxx.xxx.xxx.0/24（子网）**0.0.0.0/0（任意地址）**sg-abc（安全组） | 0.0.0.0/0  |
   | 描述                                                         | 安全组规则的描述信息，非必填项。描述信息内容不能超过255个字符，且不能包含“<”和“>”。 | -          |

8. 单击“确定”。

#### 结果验证

安全组规则配置完成后，我们需要验证对应的规则是否生效。假设您在弹性云服务器上部署了网站，希望用户能通过HTTP（80端口）访问到您的网站，您添加了一条入方向规则，如[表3](https://support.huaweicloud.com/qs-vpn/vpn_03_0802.html#vpn_03_0802__zh-cn_topic_0118534005_table30323767195135)所示。

| 方向   | 协议/应用 | 端口 | 源地址    |
| ------ | --------- | ---- | --------- |
| 入方向 | TCP       | 80   | 0.0.0.0/0 |

**Linux弹性云服务器**

Linux弹性云服务器上验证该安全组规则是否生效的步骤如下所示。

1. 登录弹性云服务器。

2. 运行如下命令查看TCP 80端口是否被监听。

   ```
   netstat -an | grep 80
   ```

   

   如果返回结果如[图3](https://support.huaweicloud.com/qs-vpn/vpn_03_0802.html#vpn_03_0802__zh-cn_topic_0118534005_fig783561113312)所示，说明TCP 80端口已开通。

   图3 Linux TCP 80端口验证结果
   ![img](https://support.huaweicloud.com/qs-vpn/zh-cn_image_0295711259.png)

3. 在浏览器地址栏里输入“http://弹性云服务器的弹性公网IP地址”。

   如果访问成功，说明安全组规则已经生效。

**Windows**弹性云服务器

Windows弹性云服务器上验证该安全组规则是否生效的步骤如下所示。

1. 登录弹性云服务器。

2. 选择“开始 > 附件 > 命令提示符”。

3. 运行如下命令查看TCP 80端口是否被监听。

   ```
   netstat -an | findstr 80
   ```

   如果返回结果如[图4](https://support.huaweicloud.com/qs-vpn/vpn_03_0802.html#vpn_03_0802__zh-cn_topic_0118534005_fig937451791814)所示，说明TCP 80端口已开通。

   图4 Windows TCP 80端口验证结果
   ![img](https://support.huaweicloud.com/qs-vpn/zh-cn_image_0295711189.png)

4. 在浏览器地址栏里输入“http://弹性云服务器的弹性公网IP地址”。

   如果访问成功，说明安全组规则已经生效。



#### 相关操作

- [安全组规则除描述字段外，其他字段均相同，是否算作相同的安全组规则？](https://support.huaweicloud.com/vpc_faq/faq_security_0004.html)
- [多通道协议相关的安全组配置方式是什么？](https://support.huaweicloud.com/vpc_faq/vpc_faq_0059.html)